# API通信デバッグガイド

## 問題の症状
- 文字起こし全文が「ご視聴ありがとうございました」と表示される
- 実際の録音内容が反映されていない可能性

## デバッグログの追加内容

### 1. OpenAIService.swift
- Whisper API呼び出し時のログ出力
- レスポンスステータスコード
- レスポンス内容
- エラー詳細

### 2. AnalysisManager.swift  
- 文字起こし結果の保存ログ
- 分析結果のログ
- ユーザー設定の取得ログ

## 確認手順

1. **Xcodeコンソールでの確認**
   - アプリを実行して録音・分析を実行
   - コンソールに出力される以下のログを確認：
     - `Starting transcription for: [ファイル名]`
     - `Transcription response status: [ステータスコード]`
     - `Transcription response: [レスポンス内容]`
     - `Transcription successful: [文字起こし結果]`
     - `Transcription saved: [保存された内容]`

2. **考えられる原因**
   - APIキーが正しく設定されていない
   - 音声ファイルが正しくアップロードされていない
   - APIからエラーレスポンスが返っている
   - モック分析が実行されている

3. **チェックポイント**
   - 設定 → API設定でAPIキーが設定されているか
   - APIキーが有効か（緑のチェックマーク）
   - ネットワーク接続が正常か

## カスタムフィラー語の設定

### 実装内容
1. OpenAIServiceでユーザー設定からカスタムフィラー語を取得
2. デフォルトフィラー語リストに追加
3. GPT-4のプロンプトに含める
4. モック分析でもカスタムフィラー語を使用

### 設定方法
1. 設定 → フィラー語設定 → 検出するフィラー語
2. カスタムフィラー語を追加（カンマ区切り）
3. 保存して録音・分析を実行

## トラブルシューティング

### APIが呼ばれていない場合
1. コンソールで「Error: API key is empty」を確認
2. KeychainManagerが正しく動作しているか確認
3. 環境変数にAPIキーを設定してテスト

### 「ご視聴ありがとうございました」が表示される場合
- これは通常、デフォルトの音声ファイルまたはサンプル音声の内容
- 実際の録音が保存されていない可能性
- 録音ファイルのパスを確認