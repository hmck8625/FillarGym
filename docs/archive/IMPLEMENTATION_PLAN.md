# FillarGym 実装計画

## 概要
このドキュメントは、FillarGymアプリの未実装機能と今後の実装順序を定義します。
基本機能は実装済みのため、価値創造機能とビジネス機能に焦点を当てます。

## 実装済み機能
✅ 基本的なUI構造（タブナビゲーション）
✅ 音声録音機能（AudioRecorderManager）
✅ Core Dataモデル（AudioSession, FillerAnalysis, FillerWord, UserSettings）
✅ 分析結果表示画面
✅ 履歴・進捗トラッキング
✅ 設定画面の基本構造
✅ モック分析機能

## 未実装機能と実装計画

### フェーズ1: コア機能の完成（1-2週間）

#### 1.1 ファイルアップロード機能
**優先度:** 高
**目的:** 既存音声ファイルからの分析を可能にする
**実装内容:**
- ファイルピッカーUI実装
- 対応フォーマット検証（m4a, wav, mp3）
- ファイル情報表示
- アップロードプログレス表示

**関連ファイル:**
- `RecordingView.swift` - ファイル選択ボタンの実装
- 新規作成: `FilePickerView.swift`
- 新規作成: `AudioFileValidator.swift`

#### 1.2 OpenAI API統合
**優先度:** 高
**目的:** 実際の音声分析機能を実装
**実装内容:**
- Whisper API統合（音声→テキスト変換）
- GPT-4 API統合（フィラー語検出）
- APIキー管理（Keychain保存）
- エラーハンドリング強化
- レート制限対応

**関連ファイル:**
- `OpenAIService.swift` - API実装の完成
- 新規作成: `KeychainManager.swift`
- `AnalysisManager.swift` - 実APIコールの実装

#### 1.3 オンボーディング画面
**優先度:** 高
**目的:** 新規ユーザーの初回体験最適化
**実装内容:**
- ウェルカム画面
- アプリ価値説明（3-4画面）
- デモ体験機能
- 権限要求フロー
- 初期設定ガイド

**関連ファイル:**
- 新規作成: `OnboardingView.swift`
- 新規作成: `OnboardingPageView.swift`
- 新規作成: `DemoExperienceView.swift`
- `FillarGymApp.swift` - 初回起動判定

### フェーズ2: プレミアム機能（1週間）

#### 2.1 StoreKit 2統合
**優先度:** 高
**目的:** サブスクリプション課金の実装
**実装内容:**
- 商品設定（月額¥480）
- 購入フロー実装
- 購入復元機能
- レシート検証
- サブスクリプション状態管理

**関連ファイル:**
- 新規作成: `StoreManager.swift`
- 新規作成: `PremiumView.swift`
- `SettingsView.swift` - プレミアム状態表示
- 新規作成: `SubscriptionManager.swift`

#### 2.2 プレミアム機能の実装
**優先度:** 中
**目的:** 有料ユーザー向け機能の提供
**実装内容:**
- 無制限分析（Free版は月5回制限）
- 詳細レポート機能
- 履歴無制限保持
- 広告非表示
- 高度な統計表示

**関連ファイル:**
- `AnalysisView.swift` - プレミアム統計追加
- 新規作成: `UsageLimitManager.swift`
- 新規作成: `PremiumAnalyticsView.swift`

### フェーズ3: データエクスポート機能（3-4日）

#### 3.1 レポート生成機能
**優先度:** 中
**目的:** 分析結果の外部共有
**実装内容:**
- PDF生成機能
- CSV出力機能
- グラフ画像エクスポート
- カスタムレポートテンプレート

**関連ファイル:**
- 新規作成: `ReportGenerator.swift`
- 新規作成: `PDFExporter.swift`
- 新規作成: `CSVExporter.swift`
- `DataManagementView.swift` - エクスポートUI改善

### フェーズ4: 高度な分析機能（1週間）

#### 4.1 AI改善アドバイス
**優先度:** 中
**目的:** パーソナライズされた改善提案
**実装内容:**
- GPT-4による動的アドバイス生成
- ユーザー履歴に基づく個別化
- シチュエーション別対策
- 改善難易度表示

**関連ファイル:**
- 新規作成: `AdviceGenerator.swift`
- 新規作成: `PersonalizedAdviceView.swift`
- `AnalysisResultView.swift` - AI アドバイス統合

#### 4.2 高度な統計分析
**優先度:** 低
**目的:** より詳細な分析情報の提供
**実装内容:**
- 統計的有意性判定
- パフォーマンス推移予測
- ベンチマーク比較
- 業界平均との比較

**関連ファイル:**
- 新規作成: `StatisticalAnalyzer.swift`
- 新規作成: `BenchmarkComparisonView.swift`
- `ProgressTracker.swift` - 統計計算の拡張

### フェーズ5: 通知・エンゲージメント（3-4日）

#### 5.1 プッシュ通知
**優先度:** 低
**目的:** ユーザーエンゲージメント向上
**実装内容:**
- 練習リマインダー
- 目標達成通知
- 週次レポート配信
- 連続利用ストリーク

**関連ファイル:**
- 新規作成: `NotificationManager.swift`
- 新規作成: `NotificationScheduler.swift`
- `SettingsView.swift` - 通知設定UI

### フェーズ6: UI/UX改善（継続的）

#### 6.1 アニメーション強化
**優先度:** 低
**実装内容:**
- 画面遷移アニメーション
- 録音時のビジュアル強化
- グラフアニメーション
- 達成時のセレブレーション

#### 6.2 ダークモード最適化
**優先度:** 低
**実装内容:**
- カラースキーム調整
- グラフカラー最適化
- アイコン対応

## 技術的考慮事項

### API設計
- RESTful API設計原則に従う
- エラーハンドリングの統一
- レート制限の実装
- キャッシュ戦略

### セキュリティ
- APIキーのセキュア保存（Keychain）
- 音声データの暗号化
- プライバシー保護
- HTTPS通信の徹底

### パフォーマンス
- 音声ファイルの効率的な処理
- Core Dataクエリの最適化
- メモリ使用量の監視
- バックグラウンドタスクの管理

### テスト戦略
- ユニットテスト（ViewModels, Services）
- UIテスト（主要フロー）
- API モックテスト
- 課金フローのテスト

## リリース計画

### v1.1（2週間後）
- ファイルアップロード
- OpenAI API統合
- オンボーディング

### v1.2（1ヶ月後）
- StoreKit 2統合
- プレミアム機能
- データエクスポート

### v1.3（6週間後）
- AI改善アドバイス
- 高度な統計
- プッシュ通知

### v2.0（3ヶ月後）
- iPad対応
- 多言語対応
- チーム機能
- Web版連携

## 次のステップ

1. **OpenAI APIキーの取得と設定**
   - Whisper APIキー
   - GPT-4 APIキー
   - 開発環境での設定

2. **App Store Connect設定**
   - アプリID登録
   - サブスクリプション商品設定
   - サンドボックステスト環境

3. **開発開始**
   - フェーズ1.1から順次実装
   - 週次でプログレスレビュー
   - ユーザーテストの実施

## 補足事項

- 各フェーズ完了時にはテストを実施
- ユーザーフィードバックを随時反映
- パフォーマンス監視を継続的に実施
- App Storeガイドラインへの準拠確認